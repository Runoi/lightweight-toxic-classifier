# –õ–µ–≥–∫–æ–≤–µ—Å–Ω—ã–π –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä —Ç–æ–∫—Å–∏—á–Ω—ã—Ö –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤ (AI_Toxic)

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –ø–æ–ª–Ω—ã–π —Ü–∏–∫–ª —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ production-ready ML-—Å–µ—Ä–≤–∏—Å–∞: –æ—Ç –æ–±—É—á–µ–Ω–∏—è –∏ –æ—Ç–ª–∞–¥–∫–∏ –ª–µ–≥–∫–æ–≤–µ—Å–Ω–æ–π –º–æ–¥–µ–ª–∏ –¥–ª—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ —Ç–æ–∫—Å–∏—á–Ω–æ—Å—Ç–∏ –≤ —Ä—É—Å—Å–∫–æ—è–∑—ã—á–Ω—ã—Ö –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è—Ö –¥–æ –µ–µ —É–ø–∞–∫–æ–≤–∫–∏ –≤ API —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º FastAPI.

## üöÄ –ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

-   **–°–≤–µ—Ä—Ö–ª–µ–≥–∫–æ–≤–µ—Å–Ω–∞—è –º–æ–¥–µ–ª—å:** –ö–≤–∞–Ω—Ç–æ–≤–∞–Ω–Ω–∞—è CNN-–º–æ–¥–µ–ª—å –≤–µ—Å–∏—Ç **~5 –ú–ë**, —á—Ç–æ –∏–¥–µ–∞–ª—å–Ω–æ –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è.
-   **–í—ã—Å–æ–∫–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:** –í—Ä–µ–º—è –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–∞ –Ω–∞ CPU —Å–æ—Å—Ç–∞–≤–ª—è–µ—Ç –µ–¥–∏–Ω–∏—Ü—ã –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥.
-   **Production-Ready API:** –ì–æ—Ç–æ–≤—ã–π –∫ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—é API-—Å–µ—Ä–≤–∏—Å –Ω–∞ FastAPI —Å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–µ–π Swagger.
-   **–ß–∏—Å—Ç–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:** –ü—Ä–æ–µ–∫—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω –ø–æ –ø—Ä–∏–Ω—Ü–∏–ø–∞–º SOLID, DRY, KISS –∏ –û–û–ü –¥–ª—è –ª–µ–≥–∫–æ–π –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –∏ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è.
-   **–í–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ—Å—Ç—å:** –ü—Ä–æ–µ–∫—Ç –≤–∫–ª—é—á–∞–µ—Ç Jupyter-–±–ª–æ–∫–Ω–æ—Ç –¥–ª—è –ø–æ–ª–Ω–æ–≥–æ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è –ø—Ä–æ—Ü–µ—Å—Å–∞ –æ–±—É—á–µ–Ω–∏—è –∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –º–æ–¥–µ–ª–∏.

## üõ†Ô∏è –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫

-   **–ú–∞—à–∏–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ:** Python, PyTorch, Natasha, scikit-learn
-   **API:** FastAPI, Pydantic, Uvicorn
-   **–†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ:** Docker
-   **–°—Ä–µ–¥–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏:** Jupyter Notebook (Kaggle), VS Code

## üìÇ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

–ü—Ä–æ–µ–∫—Ç –∏–º–µ–µ—Ç –ª–æ–≥–∏—á–µ—Å–∫—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É, —Ä–∞–∑–¥–µ–ª—è—é—â—É—é –¥–∞–Ω–Ω—ã–µ, –∫–æ–¥ –æ–±—É—á–µ–Ω–∏—è, –æ–±—É—á–µ–Ω–Ω—ã–µ –º–æ–¥–µ–ª–∏ –∏ –∫–æ–¥ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.

```
AI_Toxic/
‚îÇ
‚îú‚îÄ‚îÄ .gitignore             # –ò—Å–∫–ª—é—á–µ–Ω–∏–µ –Ω–µ–Ω—É–∂–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ –∏–∑ Git
‚îú‚îÄ‚îÄ README.md              # –≠—Ç–æ—Ç —Ñ–∞–π–ª
‚îÇ
‚îú‚îÄ‚îÄ data/                  # –î–∞–Ω–Ω—ã–µ –¥–ª—è –æ–±—É—á–µ–Ω–∏—è
‚îÇ   ‚îî‚îÄ‚îÄ raw/
‚îÇ       ‚îî‚îÄ‚îÄ dataset.csv
‚îÇ
‚îú‚îÄ‚îÄ models/                # –û–±—É—á–µ–Ω–Ω—ã–µ –º–æ–¥–µ–ª–∏ –∏ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã
‚îÇ   ‚îî‚îÄ‚îÄ v1.0/
‚îÇ       ‚îú‚îÄ‚îÄ solo_cnn_fp32.pth  (–º–∞—Å—Ç–µ—Ä-–º–æ–¥–µ–ª—å)
‚îÇ       ‚îú‚îÄ‚îÄ solo_cnn_int8.pth  (–º–æ–¥–µ–ª—å –¥–ª—è API)
‚îÇ       ‚îî‚îÄ‚îÄ vocab.json         (—Å–ª–æ–≤–∞—Ä—å)
‚îÇ
‚îú‚îÄ‚îÄ notebooks/             # Jupyter-–±–ª–æ–∫–Ω–æ—Ç —Å –ø—Ä–æ—Ü–µ—Å—Å–æ–º –æ–±—É—á–µ–Ω–∏—è
‚îÇ   ‚îî‚îÄ‚îÄ cnn_training.ipynb
‚îÇ
‚îî‚îÄ‚îÄ api/                   # –ö–æ–¥ API-—Å–µ—Ä–≤–∏—Å–∞
    ‚îú‚îÄ‚îÄ main.py
    ‚îú‚îÄ‚îÄ classifier.py
    ‚îú‚îÄ‚îÄ preprocessor.py
    ‚îú‚îÄ‚îÄ schemas.py
    ‚îú‚îÄ‚îÄ config.py
    ‚îú‚îÄ‚îÄ requirements.txt
    ‚îî‚îÄ‚îÄ Dockerfile
```

## ‚öôÔ∏è –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

–í—Å–µ –∫–æ–º–∞–Ω–¥—ã –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –∏–∑ –∫–æ—Ä–Ω–µ–≤–æ–π –ø–∞–ø–∫–∏ –ø—Ä–æ–µ–∫—Ç–∞ (`AI_Toxic/`).

1.  **–ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:**
    ```bash
    git clone [URL –≤–∞—à–µ–≥–æ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è]
    cd AI_Toxic
    ```

2.  **–°–æ–∑–¥–∞–π—Ç–µ –∏ –∞–∫—Ç–∏–≤–∏—Ä—É–π—Ç–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ:**
    ```bash
    python -m venv venv
    # –î–ª—è Windows:
    # venv\Scripts\activate
    # –î–ª—è macOS/Linux:
    # source venv/bin/activate
    ```

3.  **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:**
    –ü—Ä–æ–µ–∫—Ç –∏–º–µ–µ—Ç –¥–≤–∞ –Ω–∞–±–æ—Ä–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π: –¥–ª—è –æ–±—É—á–µ–Ω–∏—è –∏ –¥–ª—è API.
    ```bash
    # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –¥–ª—è –∑–∞–ø—É—Å–∫–∞ API
    pip install -r api/requirements.txt
    
    # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –¥–ª—è –∑–∞–ø—É—Å–∫–∞ Jupyter-–±–ª–æ–∫–Ω–æ—Ç–∞
    # –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è —Å–æ–∑–¥–∞—Ç—å –æ—Ç–¥–µ–ª—å–Ω—ã–π requirements.txt –¥–ª—è –±–ª–æ–∫–Ω–æ—Ç–∞
    pip install pandas jupyter scikit-learn
    ```

## üöÄ –ü–æ—Ä—è–¥–æ–∫ —Ä–∞–±–æ—Ç—ã

### 1. –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ (–¥–ª—è –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è)

-   –û—Ç–∫—Ä–æ–π—Ç–µ –∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ —è—á–µ–π–∫–∏ –≤ –±–ª–æ–∫–Ω–æ—Ç–µ `notebooks/cnn_training.ipynb`.
-   –≠—Ç–æ—Ç –±–ª–æ–∫–Ω–æ—Ç –≤—ã–ø–æ–ª–Ω–∏—Ç –≤—Å–µ —à–∞–≥–∏: –æ—Ç –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö –¥–æ –æ–±—É—á–µ–Ω–∏—è, –æ—Ü–µ–Ω–∫–∏ –∏ –∫–≤–∞–Ω—Ç–∏–∑–∞—Ü–∏–∏ –º–æ–¥–µ–ª–∏.
-   –í —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ –≤ –ø–∞–ø–∫–µ `models/v1.0/` –±—É–¥—É—Ç —Å–æ–∑–¥–∞–Ω—ã –≤—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã (`.pth` —Ñ–∞–π–ª—ã –∏ `vocab.json`).

### 2. –ó–∞–ø—É—Å–∫ API (–¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è)

–í—ã –º–æ–∂–µ—Ç–µ –∑–∞–ø—É—Å—Ç–∏—Ç—å API –ª–æ–∫–∞–ª—å–Ω–æ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –∏–ª–∏ —á–µ—Ä–µ–∑ Docker –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞.

**–õ–æ–∫–∞–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫:**
```bash
# –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—ã –Ω–∞—Ö–æ–¥–∏—Ç–µ—Å—å –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞ AI_Toxic/ –∏ venv –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–æ
uvicorn api.main:app --reload
```
–û—Ç–∫—Ä–æ–π—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ [http://127.0.0.1:8000/docs](http://127.0.0.1:8000/docs) –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏.

**–ó–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ Docker:**
```bash
# 1. –°–±–æ—Ä–∫–∞ –æ–±—Ä–∞–∑–∞
docker build -t toxic-classifier-api . -f api/Dockerfile

# 2. –ó–∞–ø—É—Å–∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
docker run -d -p 8000:8000 --name my-toxic-api toxic-classifier-api```

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

–§–∏–Ω–∞–ª—å–Ω–∞—è –º–æ–¥–µ–ª—å –≤–µ—Ä—Å–∏–∏ `v1.0` –±—ã–ª–∞ –æ—Ü–µ–Ω–µ–Ω–∞ –Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω–æ–π –≤—ã–±–æ—Ä–∫–µ –∏ –ø–æ–∫–∞–∑–∞–ª–∞ —Å–ª–µ–¥—É—é—â–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã:

-   **–†–∞–∑–º–µ—Ä –∫–≤–∞–Ω—Ç–æ–≤–∞–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏:** ~5 –ú–ë
-   **F1-score (—Ç–æ–∫—Å–∏—á–Ω—ã–π –∫–ª–∞—Å—Å):** **0.58**

### –ú–µ—Ç—Ä–∏–∫–∏ –¥–ª—è –ª—É—á—à–µ–π –º–æ–¥–µ–ª–∏:

| –ö–ª–∞—Å—Å         | Precision | Recall | F1-score |
|---------------|-----------|--------|----------|
| –ù–µ—Ç–æ–∫—Å–∏—á–Ω—ã–π (0) | 0.78      | 0.88   | 0.83     |
| **–¢–æ–∫—Å–∏—á–Ω—ã–π (1)** | **0.68**  | **0.51**   | **0.58** |

### –ú–∞—Ç—Ä–∏—Ü–∞ –æ—à–∏–±–æ–∫:

|                 | –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–æ: –ù–µ—Ç–æ–∫—Å–∏—á–Ω—ã–π | –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–æ: –¢–æ–∫—Å–∏—á–Ω—ã–π |
|-----------------|--------------------------|------------------------|
| **–†–µ–∞–ª—å–Ω—ã–π: –ù–µ—Ç–æ–∫—Å–∏—á–Ω—ã–π** | 1685 (TN)                | 233 (FP)               |
| **–†–µ–∞–ª—å–Ω—ã–π: –¢–æ–∫—Å–∏—á–Ω—ã–π**   | 473 (FN)                 | 492 (TP)               |

**–ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è:** –ú–æ–¥–µ–ª—å —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ "–æ—Å—Ç–æ—Ä–æ–∂–Ω–æ–º" —Ä–µ–∂–∏–º–µ. –ö–æ–≥–¥–∞ –æ–Ω–∞ –ø–æ–º–µ—á–∞–µ—Ç –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –∫–∞–∫ —Ç–æ–∫—Å–∏—á–Ω—ã–π, –æ–Ω–∞ –ø—Ä–∞–≤–∞ –≤ 68% —Å–ª—É—á–∞–µ–≤ (`Precision`), –Ω–æ –ø—Ä–∏ —ç—Ç–æ–º –Ω–∞—Ö–æ–¥–∏—Ç —Ç–æ–ª—å–∫–æ 51% –≤—Å–µ—Ö —Ç–æ–∫—Å–∏—á–Ω—ã—Ö –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤ (`Recall`). –ë–∞–ª–∞–Ω—Å –º–æ–∂–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å —Å –ø–æ–º–æ—â—å—é –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ `threshold` –≤ API.

## üí° –ö–ª—é—á–µ–≤—ã–µ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ä–µ—à–µ–Ω–∏—è –≤ —Ö–æ–¥–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

-   **–¢–æ–∫–µ–Ω–∏–∑–∞—Ü–∏—è:** –ò–∑-–∑–∞ –ø—Ä–æ–±–ª–µ–º —Å –ª–µ–º–º–∞—Ç–∏–∑–∞—Ü–∏–µ–π `natasha` –≤ –æ–±–ª–∞—á–Ω–æ–π —Å—Ä–µ–¥–µ –±—ã–ª –≤—ã–±—Ä–∞–Ω –±–æ–ª–µ–µ –Ω–∞–¥–µ–∂–Ω—ã–π –ø–æ–¥—Ö–æ–¥ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º `Segmenter` –¥–ª—è —Ç–æ–∫–µ–Ω–∏–∑–∞—Ü–∏–∏ –∏ –ø–æ—Å–ª–µ–¥—É—é—â–µ–π —Ä—É—á–Ω–æ–π –æ—á–∏—Å—Ç–∫–∏.
-   **–°—Ç–∞–±–∏–ª–∏–∑–∞—Ü–∏—è –æ–±—É—á–µ–Ω–∏—è:** –ú–æ–¥–µ–ª—å –±—ã–ª–∞ —Å–∫–ª–æ–Ω–Ω–∞ –∫ –∫–æ–ª–ª–∞–ø—Å—É (–ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ –æ–¥–Ω–æ–≥–æ –∫–ª–∞—Å—Å–∞). –ü—Ä–æ–±–ª–µ–º–∞ –±—ã–ª–∞ —Ä–µ—à–µ–Ω–∞ –∫–æ–º–±–∏–Ω–∞—Ü–∏–µ–π `BatchNorm1d`, `ReLU` –∫–∞–∫ –º–æ–¥—É–ª—è, `gradient clipping` –∏ `CosineAnnealingLR`.
-   **–ö–≤–∞–Ω—Ç–∏–∑–∞—Ü–∏—è:** –î–ª—è —É—Å–ø–µ—à–Ω–æ–π –∫–≤–∞–Ω—Ç–∏–∑–∞—Ü–∏–∏ –ø–æ—Ç—Ä–µ–±–æ–≤–∞–ª–æ—Å—å —è–≤–Ω–æ —É–∫–∞–∑–∞—Ç—å "–º–æ—Å—Ç—ã" (`QuantStub`, `DeQuantStub`), –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π `qconfig` –¥–ª—è `nn.Embedding` –∏, —á—Ç–æ —Å–∞–º–æ–µ –≤–∞–∂–Ω–æ–µ, **—è–≤–Ω–æ —Å–ª–∏–≤–∞—Ç—å (fuse) –º–æ–¥—É–ª–∏ `Conv-BN-ReLU`** –ø–µ—Ä–µ–¥ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–æ–π –º–æ–¥–µ–ª–∏.
